import { maybeInterval } from '../helpers/autoTicks.js';
import { resolveChannel } from '../helpers/resolve.js';
export function intervalX(args, { plot }) {
    return interval('x', plot, args);
}
export function intervalY(args, { plot }) {
    return interval('y', plot, args);
}
function interval(dim, plot, { data, ...options }) {
    if (options.interval &&
        options[dim] &&
        options[`${dim}1`] == null &&
        options[`${dim}2`] == null) {
        // derive x1 and x2 from x+interval
        const interval = maybeInterval(options.interval, plot.scales[dim].type);
        const newData = data.map((row) => {
            const val = resolveChannel(dim, row, options);
            return {
                ...row,
                [`__${dim}1`]: interval.floor(val),
                [`__${dim}2`]: interval.offset(interval.floor(val))
            };
        });
        return {
            data: newData,
            // set default inset
            [`inset${dim === 'x' ? 'Right' : 'Bottom'}`]: 1,
            ...options,
            [`${dim}1`]: `__${dim}1`,
            [`${dim}2`]: `__${dim}2`
        };
    }
    return { data, ...options };
}
